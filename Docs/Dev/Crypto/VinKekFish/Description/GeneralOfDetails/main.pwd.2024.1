Главный режим работы для шифрования первичного ключа

1. Генерация шума на три (два, если есть канал со скрытыми данными) канала. Шумы генерируются суммой губок: один поток - два ключа (на каждую губку). Первый канал выравнивается по длине (если скрытые данные меньше, чем первый канал, то в шифровании отказывается), остальные каналы имеют длину, равную первому каналу. Размер данных помещается отдельно внутри зашифрованного (потом) канала. Размер выравненных каналов помещается в незашифрованном виде. В случае шифрования шума, размер скрытых данных в каналах не ставится (просто сразу идёт шум).
2. Каждый канал (включая шумы) гаммируется с обратной связью каскадом своим ключом (как будто содержит данные) и подписывается хешем с этим же ключом (дуплекс с хешем в один проход). Для каскадной губки размер хеша равен её номинальной стойкости (64*tall).

ВСТАВИТЬ СЮДА ПЕРЕМЕШИВАНИЕ КАЖДОГО КАНАЛА!!!! КАК? Ведь нужно ещё и обращение порядка байтов!

3. Каждый канал (отдельно от других) подвергается обращению порядка байтов (первый байт становится последним; хеш с инвертированным порядком байтов идёт первым). Затем на каждый канал отдельно (со своим ключом) налагается гамма из суммы губок (без вычисления хеша).
4. Каждый канал гаммируется с обратной связью с помощью VinKekFish (также с хешированием).
5. Всего четыре канала: основные данные, шум или резервные данные, шум по двум остальным каналам. Каналы не смешиваются, байты каналов просто идут друг за другом. Затем выполняется перестановка байтов с помощью каскадной губки на всём файле.
6. Гаммирование с обратной связью с помощью каскадной губки без хеша.
7. Гаммирование с помощью суммы губок без хеша.
8. Инвертирование порядка байтов. Гаммирование с обратной связью с хешированием с помощью VinKekFish. Хеш в конце размером 8 кибибайтов * K.
