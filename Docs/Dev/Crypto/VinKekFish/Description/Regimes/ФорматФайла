Формат файла

Функция AddStartPart
1. 1 байт. regimeLen0 ("Regime len"[0]). Указывает на длину строки asciiRegimeName, которая описывает режим. Значение равно asciiRegimeName-MinLengthForRegimeName (MinLengthForRegimeName=16).
2. 1 байт. vkfOpt.K ("Regime len"[1]). Коэффициент стойкости шифрования VinKekFish ([1,19], нечётный).
3. Variable ulong. SIB64 = cscOpt.StrengthInBytes/64. "Regime len"[2..]. Стойкость шифрования в блоках по 64-ре байта.
4. Variable ulong. vkfRounds. Количество раундов для VinKekFish.
5. Variable ulong. vkfPreRounds. Количество раундов для VinKekFish с константными таблицами.
6. Variable ulong. ArmoringSteps - настройка дополнительного количества раундов для каскадной губки.

7. recRegimeName. Обфусцированная строка, которая описыват режим шифрования. Строка asciiRegimeName закрыта с помощью операции сложения с далее следующими байтами obfRegimeName.

8. 2*(2 байта + len(SIB64) + len(recRegimeName)). obfRegimeName ("Regime name add"). Каждый из байтов случайно сгенерирован. Массив дважды складывается с массивом "Regime len" и с recRegimeName для их обфускации. Сложение сначала идёт с "Regime len" дважды последовательно и отдельно (без переноса битов), потом аналогично дважды последовательно с recRegimeName.
Двойное сложение используется для того, чтобы не было простых зависимостей (два байта различаютя на единицу в разных позициях). Это немного усложняет распознавание формата файла неспециализированными средствами или вручную.


Шифрованная часть


