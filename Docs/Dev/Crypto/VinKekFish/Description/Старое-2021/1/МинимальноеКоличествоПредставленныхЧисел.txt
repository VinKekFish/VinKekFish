Пробуем ещё раз (см. ниже "НЕВЕРНЫЙ РАСЧЁТ" для первого раза)

См. численные расчёты в \VinKekFish_cryptoDev\permutationsTest\bPtBWjTY84jo\PermutationCalc
(pc3 и pc4)

Какова вероятность того, что число (из b вариантов) встретится ровно k раз в гамме из n значений?

Очевидно, что если k = n, то вероятность b^-n.
Если k = 0?
Если число не встретилось один раз - это (1-1/b). Соответственно, (1-1/b)^n - это вероятность того, что число не встретилось ни разу.

Какова вероятность того, что число встретится ровно один раз (k = 1)?
Для n = 1 это, очевидно, 1/b.
Для n = 2 уже сложнее.
Число может выпасть на первое значение, тогда это 1/b*(1-1/b)^n.
Может выпасть на второе значение, тогда это (1-1/b)*1/b.
То есть общая вероятность 2 * (1-1/b)*1/b

Для n = 3 и k = 1 есть три варианта.
Все они 1/b*(1-1/b)^(n-1)
То есть вероятность должна быть 3 * 1/b*(1-1/b)^(n-1)

Можем угадать, что формула для любого n и k=1 будет следующая
n * 1/b*(1-1/b)^(n-1)

Для n = 2 и k = 2
1/b^2

Для n = 3 и k = 2
110
101
011
Количество вариантов равно количеству сочетаний трёх элементов по два n!/k!(n-k)!, то есть 3!/2!(3-2)!=3
(мы выкладываем три позиции без повторений в 2 ящика - наши единицы)

Таким образом, 3 * 1/b^k*(1-1/b)^(n-k)

Для n = 4 и k = 2
1100
1001
1010
0101
0110
0011

6 вариантов. n!/k!(n-k)! = 4!/2!/(4-2)! = 4*3/2 = 12/2 = 6
6 * 1/b^k*(1-1/b)^(n-k)

Для n = 5 и k = 3
11100
11001
11010
10011
10101
10110
01011
01101
01110
00111

10 вариантов.
n!/k!(n-k)! = 5!/3!/(5-3)! = 10

Таким образом, можно прийти к формуле n!/k!/(n-k)! * 1/b^k*(1-1/b)^(n-k)

Это, кстати, формула Бернулли.


----------------------------------------------------------------
НЕВЕРНЫЙ РАСЧЁТ
Расчёт не учитывает, что варианты не являются равновероятными

См. численные расчёты в \VinKekFish_cryptoDev\permutationsTest\bPtBWjTY84jo\PermutationCalc
(pc1 и pc2)

Количество сочетаний с повторениям
V(m, n) = (m + n - 1)! / (  n!*(m-1)!  )

Возьмём гамму из n чисел. Разобьём гамму на числа, с количеством битов, в которых представлено b вариантов (например, если мы разбили гамму побайтово, то b = 256).
Для каждого варианта (каждого числа из b) рассчитаем количество встреч конкретного числа в гамме. Минимальное количество встреч - m.

Рассчитаем полное количество вариантов таких встреч. Это будет количество сочетаний с повторениями из n чисел по b ящикам (b вариантам чисел).

Те есть V(n, b) = (n + b - 1)! / (  n!*(b-1)!  )
Это полное количество вариантов сочетаний с повторениями
Число сочетаний с повторениями из b по n

n!/k!/(n-k)! = C[k, n]
V(k, n)=C[k, k+n-1]
(k+n-1)!/k!/(k+n-1-k)!

(k+n-1)!/k!/(n-1)!
Где k есть количество элементов в гамме, а n - количество ящиков (классов; вариантов чисел).

Представим себе, что у нас уже заполнены m ячеек для каждого числа.
Тогда количество вариантов в данном варианте будет
V(n - m*b, b) = (n - m*b + b - 1)! / (  (n - m*b)!*(b-1)!  )

Вероятность того, что минимальное количество встреченных чисел будет m или выше равна
